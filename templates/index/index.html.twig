{% extends 'layouts/layout.html.twig' %}

{% block page_title 'Accueil' %}

{% block content %}

    <nav class="navbar navbar-expand-lg navbar-dark bg-dark border-0 SL-float">
        <div class="container">
            <div class="collapse navbar-collapse" id="navbarTogglerDemo02">
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar8">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <span class="navbar-text">&nbsp;</span>
                <ul class="navbar-nav ml-auto">
                    {% if is_granted('IS_AUTHENTICATED_FULLY') %}
                        <li id="anchor-nav-cards4" class="nav-item">
                            <a id="anchor-a-cards4" class="nav-link"
                               href="{{ path('user_profile') }}">{% trans %}nav.profile{% endtrans %}</a>
                        </li>
                        <li id="anchor-nav-cards5" class="nav-item">
                            <a id="anchor-a-cards5" class="nav-link"
                               href="{{ path('deconnexion') }}">{% trans %}nav.logout{% endtrans %}</a>
                        </li>
                    {% else %}
                        <li id="anchor-nav-cards1" class="nav-item">
                            <a id="anchor-a-cards1" class="nav-link"
                               href="{{ path('security_signup') }}">{% trans %}nav.signup{% endtrans %}</a>
                        </li>
                        <li id="anchor-nav-cards2" class="nav-item">
                            <a id="anchor-a-cards2" class="nav-link" data-toggle="modal"
                               data-target="#modal-connexion">{% trans %}nav.login{% endtrans %}</a>
                        </li>
                    {% endif %}
                    {% if is_granted('ROLE_ADMIN') %}
                        <li id="anchor-nav-cards3" class="nav-item">
                            <a id="anchor-a-cards3" class="nav-link"
                               href="{{ path('admin_index') }}">{% trans %}nav.admin{% endtrans %}</a>
                        </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>

    <div class="row mt-3">
        <div class="mx-auto"><img src="{{ asset('images/logo_1.png') }}" alt=""></div>
    </div>

    <div class="row">
        <div class="col-12">
            <h3 class="text-center">Bienvenue au Shinigami Laser !</h3>
            <p class="text-justify accroche">
                Venez vous amuser dans notre univers d'amusement futuriste hors de l'ordinaire.
                Laser Tag, Nerf Tag, Réalité Virtuelle, Tag à l'arc, Ballon Chasseur UV, Arcade, casse-croute et
                plusieurs autres événements et spectacles thématiques.

                En plus de nos activités régulières, nous offrons aussi des forfaits pour anniversaires, l'organisation
                d'événements de Team building pour les entreprises et nous avons aussi une équipe mobile pour différents
                festivals.

                Shinigami Laser comprend plus de 350 centres un peu partout sur la planète. Notre système de carte de
                fidélité vous
                permet de vous connecter sur une plateforme en ligne et comparer vos statistiques avec des milliers
                d'autres joueurs.
            </p>
        </div>
    </div>

    <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
        <ol class="carousel-indicators">
            <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
            <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
            <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
        </ol>
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img class="d-block w-100" src="{{ asset('images/laser-game222.jpg') }}" alt="First slide">
            </div>
            <div class="carousel-item">
                <img class="d-block w-100" src="{{ asset('images/laser-game.jpg') }}" alt="Second slide">
            </div>
            <div class="carousel-item">
                <img class="d-block w-100" src="{{ asset('images/XRaid-laserGames.png') }}" alt="Third slide">
            </div>
        </div>
        <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
        </a>
    </div>

    <div class="row"></div>

    <!-- Row règles -->
    <div class="row mt-lg-3">
        <div class="col-12"><h5 class="text-center">Règles</h5></div>
        <div class="col-sm-12 col-lg-4">
            <h6 class="text-primary">Un laser Game ?</h6>
            <p>C'est quoi exactement ce jeu qui fait fureur dans tout l'hexagone et au-delà des frontières ? Les portes
                du SAS s'ouvrent sur un nouvel univers dans lequel tes amis, patrons, parents deviendront tes
                adversaires.
            </p>
            <p> Equipé d'un harnais cible et d'un pistolet laser, muni de capteurs infrarouges, c'est toi le héros.
            </p>
            <p>Ta mission est de faire perdre des points à ton adversaire en faisant preuve de stratégie et d'agilité
                afin qu'il ne t'atteigne pas.</p>

        </div>
        <div class="col-sm-12 col-lg-4">
            <h6 class="text-primary">Plusieurs modes de jeu</h6>
            <ul>
                <li>
                    En mode TEAM (deux ou trois équipes), les joueurs verts doivent viser les boîtiers et pistolets des
                    rouges ou mixte et réciproquement.
                </li>
                <li>En mode Solo, chacun joue pour soi et doit viser tous les boîtiers et pistolets.</li>
            </ul>
        </div>
        <div class="col-sm-12 col-lg-4">
            <h6 class="text-primary">Les règles du jeu</h6>
            <p>Quelques règles simples sont à respecter pour accroître la difficulté :</p>
            <ul>
                <li>Lorsque ton harnais est désactivé, tu ne peux ni tirer ni te faire toucher pendant 5 (ou 2) secondes
                    alors profites en pour repenser ta stratégie.
                </li>
                <li>
                    Après 20 minutes de combat sans répit, une fiche de score récapitulative t'es remise ; tu sais alors
                    qui t'a touché, où et combien de fois.
                </li>
                <li>Pas de violence, pas de brutalité, juste une bonne dose de rigolade.</li>
            </ul>
        </div>

    </div>

    <!-- Row images -->
    <div class="row mt-lg-3">
        <div class="col-sm-12 col-lg-4">
            <img src="{{ asset('images/1_23112011195536.jpg') }}" alt="" class="rounded img-fluid">
        </div>
        <div class="col-sm-12 col-lg-4">
            <img src="{{ asset('images/58_22062010224807.jpg') }}" alt="" class="rounded img-fluid">
        </div>
        <div class="col-sm-12 col-lg-4">
            <img src="{{ asset('images/75_25072010194113.jpg') }}" alt="" class="rounded img-fluid">
        </div>
    </div>

    <!-- Row Stratégie -->
    <div class="row mt-lg-3">
        <div class="col-12"><h5 class="text-center">Stratégie et esprit d'équipe</h5></div>
        <div class="col-sm-12 col-lg-4">
            <h6 class="text-primary">Connaître les lieux</h6>
            <p>Toute élaboration stratégique dans un lieu inconnu reste hasardeuse. Alors essayez d'effectuer une partie
                durant laquelle vous pourrez faire connaissance avec la salle, en repérer les pièges, les lieux
                d'embuscade ou d'observation, et pourquoi pas en profiter pour en faire une carte : cela vous permettra
                d'élaborer des plans stratégiques précis avant de commencer une nouvelle partie.</p>
            <h6 class="text-primary">Les coéquipiers</h6>
            <p>
                Là aussi, il vaut mieux connaître ses troupes : certains auront un esprit d'attaquant téméraire,
                d'autres préfèreront vous couvrir... A vous de bien placer vos troupes là où elles seront les plus
                efficaces.
            </p>
        </div>
        <div class="col-sm-12 col-lg-4">
            <h6 class="text-primary">Les adversaires</h6>
            <p>La véritable aventure commence lorsque vous ne connaissez pas vos adversaires. Mais si vous pratiquez
                régulièrement contre eux, n'hésitez pas à étudier leurs comportements : ils auront tendance à appliquer
                eux aussi des stratégies qui auront déjà fait leurs preuves ! Communiquer avec ses équipier Lorsque vous
                serez passé par le SAS, et pénétrerez dans la pénombre, il va vous falloir communiquer avec vos
                troupes.</p>
            <p>Mais ne pas vous faire comprendre par vos adversaires. Alors essayez de mettre en place des "codes" de
                communication, pour surprendre l'ennemi là où il vous attend le moins.</p>
        </div>
        <div class="col-sm-12 col-lg-4">
            <h6 class="text-primary">Ne négligez pas votre défense</h6>
            <p>Les gagnants ne sont pas forcément ceux qui tirent le plus lors d'une partie : pour éviter de vous faire
                toucher pendant votre progression, essayez de vous déplacer par deux. Pendant que le premier équipier
                progresse, le second reste en retrait et veille à ce qu'aucun adversaire ne les surprenne par derrière
                !</p>
        </div>
    </div>

    <!-- Modal connexion -->
    <div class="modal fade" id="modal-connexion" tabindex="-1" role="dialog" data-backdrop="false">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Connexion</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form class="form-horizontal centrage" id="form_login">

                        {# Email et Mot de Passe #}

                        <div class="form-row">
                            <div class="form-group col-md-6">
                                <label for="mon_id">Adresse mail</label>
                                <input name="_username" id="login-username"
                                        {% if last_email is defined %}
                                            value="{{ last_email }}"
                                        {% endif %}
                                       class="form-control" type="email"
                                       placeholder="Saisissez votre Email">
                            </div>
                            <div class="form-group col-md-6">
                                <label for="mon_id">Mot de passe</label>
                                <input name="_password" id="login-password"
                                       class="form-control" type="password"
                                       placeholder="*******">
                            </div>
                        </div>

                        <input type="hidden" name="_target_path" value="{{ path('user_profile') }}"/>

                        <div class="form-group col-12 text-center">
                            {# Bouton Submit #}
                            <button id="btn-connexion" type="submit" class="btn btn-info mb-1 w-35"><i
                                        id="loading-spinner" class="fas fa-spinner fa-spin"></i><span
                                        id="text-connexion"> Connexion</span></button>
                            <br>
                            <a href="{{ path('security_lostPassword') }}">Mot de passe oublié</a>

                        </div>

                    </form>
                </div>

            </div>
        </div>
    </div>

{% endblock %}

{% block outside %}
    <div id="wrap">
        <div id="card-success-login" class="card text-white bg-success mb-3" style="max-width: 20rem;">
            <div class="card-body">
                <h4 id="card-success-login-text" class="card-title"></h4>
            </div>
        </div>
    </div>
{% endblock %}

{% block final_javascripts %}
    <script>
        $(function () {

            // modal connexion
            $('#loading-spinner').hide();
            $('#text-connexion').show();

            $('#form_login').submit(function (e) {

                e.preventDefault();
                $('#loading-spinner').show();
                $('#text-connexion').hide();
                $('#btn-connexion').prop('disabled', true);

                let username = $('#login-username').val();
                let password = $('#login-password').val();

                $.post("/login", {_username: username, _password: password})
                    .done(function (response) {
                        console.log(response);
                        if (response.success === false) {
                            $('#btn-connexion')
                                .removeClass('btn-info')
                                .addClass('btn-danger');
                            $('#loading-spinner').hide();
                            $('#text-connexion').show().text('Bad credentials');

                            $('#login-username').change(function(){
                                $('#text-connexion').text('Connexion');
                                $('#btn-connexion')
                                    .prop('disabled', false)
                                    .removeClass('btn-danger')
                                    .addClass('btn-info');
                            });
                            $('#login-password').change(function(){
                                $('#text-connexion').text('Connexion');
                                $('#btn-connexion')
                                    .prop('disabled', false)
                                    .removeClass('btn-danger')
                                    .addClass('btn-info');
                            });
                        }

                        if (response.success === true) {
                            $('#modal-connexion').addClass('animated bounceOutRight');

                            let user = JSON.parse(response.user);

                            $('#anchor-a-cards1').text('{{ 'nav.profile'|trans }}')
                                .attr('href', '{{ path('user_profile') }}')
                                .removeAttr('data-toggle')
                                .removeAttr('data-target');

                            $('#anchor-a-cards2').text('{{ 'nav.logout'|trans }}')
                                .attr('href', '{{ path('deconnexion') }}')
                                .removeAttr('data-toggle')
                                .removeAttr('data-target');

                            setTimeout(function () {
                                $('#card-success-login').addClass('animated bounceInLeft');
                                $('#card-success-login-text').text('Bienvenue ' + user.firstname + ' ! ');
                            }, 799);

                            setTimeout(function () {
                                $('#card-success-login').show();
                            }, 800);

                            setTimeout(function(){
                                $('#card-success-login').addClass('animated bounceOutRight')
                            }, 2800);
                            
                            if (response.url != null){
                                document.location = response.url;
                            }

                        }
                    });
            });
        })
    </script>
{% endblock %}
